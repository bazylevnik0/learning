extern scanf
extern printf
extern exit

section .bss               
    a resb 4
    b resb 4

section .data                              
    formatd: db "%d", 0
    formatf: db "%f", 0
    array db 0, 0


section .text
    global main
    

main:
    push rax    ;stack align

    ;read a
    mov al, 0 
    lea rdi, [formatd]
	lea rsi, [a]
    call scanf

    ;read b
    mov al, 0 
    lea rdi, [formatd]
	lea rsi, [b]
    call scanf
    
    ;d a / b
    ;mov rdx, 0
    ;mov rax, [a]
    ;mov rcx, [b]
    ;div rcx
    ;mov [a], rax 
    
    ;test
    mov rax, [a]
    mov [array+0],rax
    mov rax, [b]
    mov [array+4],rax
    mov rax, [array+0]
    mov [a],rax
    mov rax, [array+4]
    mov [b],rax


    ;convert & calc
    mov eax, [a]
    cvtsi2sd xmm0, eax
    mov ecx, [b]
    cvtsi2sd xmm1, ecx
    divsd xmm0, xmm1
    movsd [a], xmm0


    ;f print
    mov rdi, formatf 
    movsd xmm0, [a]    
    mov al,1  
    call printf                


    ;d print
    ;mov rdi, formatd 
    ;mov rsi, [a]    
    ;mov al,0  
    ;call printf                


    ;exit
    mov rax,0
    call exit
